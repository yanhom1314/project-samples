= IPTABLES配置
== 命令设置

* 执行命令

[source, bash]
--------------------
#!/bin/bash
#允许特定IP:218.94.154.78访问本机22端口
iptables -I INPUT -p tcp -s 218.94.154.78 --dport 22 -j ACCEPT
iptables -I OUTPUT -p tcp -d 218.94.154.78 --sport 22 -j ACCEPT
#允许特定IP:122.96.25.42访问本机22端口
iptables -I INPUT -p tcp -s 122.96.25.42 --dport 22 -j ACCEPT
iptables -I OUTPUT -p tcp -d 122.96.25.42 --sport 22 -j ACCEPT
#允许所有IP访问80端口
iptables -I INPUT -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -I OUTPUT -p tcp --sport 80 -m state --state NEW,ESTABLISHED -j ACCEPT

#取消其他端口的访问规则，远程连接时这个不要执行
#iptables -P INPUT DROP
#iptables -P FORWARD DROP
#iptables -P OUTPUT DROP

#允许已建立的或相关连的通行
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT  
#允许本机回还接口
iptables -A INPUT -i lo -j ACCEPT
#允许本机对外的访问
iptables -A OUTPUT -j ACCEPT
--------------------

* 保存

  service iptables save  ;; 保存前先备份/etc/sysconfig/iptables文件


== 内容
    
./etc/sysconfig/iptables
[source,bash]
----------------
# Generated by iptables-save v1.4.7 on Mon Jan  4 20:07:03 2016
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
-A INPUT -p tcp -m tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT 
-A INPUT -s 122.96.25.42/32 -p tcp -m tcp --dport 22 -j ACCEPT 
-A INPUT -s 218.94.154.78/32 -p tcp -m tcp --dport 22 -j ACCEPT 
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT 
-A INPUT -i lo -j ACCEPT 
-A OUTPUT -p tcp -m tcp --sport 80 -m state --state NEW,ESTABLISHED -j ACCEPT 
-A OUTPUT -d 122.96.25.42/32 -p tcp -m tcp --sport 22 -j ACCEPT 
-A OUTPUT -d 218.94.154.78/32 -p tcp -m tcp --sport 22 -j ACCEPT 
-A OUTPUT -j ACCEPT 
COMMIT
# Completed on Mon Jan  4 20:07:03 2016
----------------
